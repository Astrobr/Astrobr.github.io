---
title: 解决幻16睡眠自动唤醒问题与电源管理解锁
date: 2021-08-19 17:00:00
categories: 
	- [Others]
	#...
tags: 
	- Windows 10
	- ROG
	- Others

#If you need a thumbnail photo for your post, delete the well number below and finish the directory.
cover: https://astrobear.top/resource/astroblog/thumbnail/zephyrus16.jpg

thumbnail: https://astrobear.top/resource/astroblog/thumbnail/zephyrus16.jpg

#If you need to customize your excerpt, delete the well number below and input something. You can also input <!-- more --> in your article to divide the excerpt and other contents.
excerpt: 怀念macOS...

#If you don't want to show the ToC (Table of Content) at sidebar, delete the well number below. 

#toc: false

#You can begin to input your article below now.

---

# 简单聊聊幻16

最近换了一台ROG的幻16，我对这台电脑各方面都还比较满意。最开始我是想买xps17的，但是xps9710今年的更新只把显卡升级到了3060（60W丐中丐），然后可选配置砍了好多，同配置9710比9700还贵了1k+。可能戴尔这定价策略就是普确信吧😅。把xps17从选择中一脚踹走之后，我把幻16、灵越16plus、Thinkbook 16p、灵刃15纳入了考虑范围。但是灵越16plus散热拉胯，Thinkbook 16p实在太丑，于是也被排除。决赛圈是幻16和灵刃15。灵刃15的外观和性能都相当吸引人，但是对于我这种重度办公用户，它败就败在没有16:10的屏幕。最终我还是选择了幻16。

幻16综合来说是一台素质非常不错的电脑（所谓“创意设计笔记本”）。相比于游戏本它的外观比较低调（虽然我觉得A面的彩虹亮片装饰还是有些张扬），然后键盘也没有花里胡哨的RGB灯。这种简洁的外观设计对办公人士是相当友好的。

其次，幻16没有数字小键盘是另一个吸引我的设计。我个人还是比较喜欢Macbook上那种键盘布局的，数字小键盘对于我来说没多大用处而且占C面空间。取消小键盘带来的额外空间被用于布置扬声器。幻16上配置有6单元的扬声器，其音响效果非常不错，这是让我感到比较惊艳的一点。此外C面还安装有一块硕大的玻璃触控板，手感亦是上佳（虽然仍然比不上Macbook）。幻16的开机键集成了指纹解锁功能，免除了输入密码的烦恼，相当方便。

这台电脑的屏幕素质亦是相当优秀：2K分辨率、16:10的比例、P3色域、165Hz刷新率、以及极高的屏占比。在日常使用中，我几乎不会感知到像素点。由于是IPS屏幕，因此其或多或少有点漏光。这块屏幕的素质足够胜任一般的图像处理与视频剪辑工作了。

我入手的这台低配幻16的硬件属于标准的创意设计笔记本的配置：11代Intel酷睿i7，RTX3060（80W，6G显存），板载内存8G+一个最高可以扩展到32G的内存插槽（DDR4，3200MHz），标配三星512G的硬盘（PCIE-4）以及一个PCIE-3的M.2硬盘插槽。如果是高配版则有RTX3070（8G显存）以及16G板载内存。

幻16的接口还是比较丰富的。它有一个雷电4口（USB Type-C）、三个USB3接口（1个USB Type-C，2个USB A）、RJ45网线接口、HDMI接口、3,5mm耳机/麦克风接口、DC电源接口。另外，幻16还配有一个读卡器，不过比较尴尬的是它是一个TF卡的读卡器......

下面讲讲我觉得这台电脑存在的不足之处：

- 品控不稳定：光这个点就可以说好多好多......

  根据网友反映，这台电脑存在品控问题有：

  - 屏幕弯曲（通病）

  - 按压屏幕上缘摄像头周围会出现松动异响（通病）

  - 屏幕漏光严重（部分出现）

  - 电流声、电容高频啸叫（通病）

  - 键盘按键喷漆不均匀，打开键盘背光漏光（本人独一家，目前网上还没有类似情况，已换）

    ![奥创中心与禁用麦克风的按键上缘漏光](https://astrobear.top/resource/astroblog/content/rog_key_painting_issue.jpeg)

  - 键盘按键（B、N键）不平（通病）

- C面上缘的指示灯太亮了，屏幕会反射灯光，有点影响体验，目前我把三个灯用黑胶布贴上了

- 在高负载时，风扇噪音实在太吵，在风扇转速最高时，我测得的人位噪声有50dB，另外即便如此C面还是很烫

- C面的类肤质材料不易清洁

如果上面的几个问题可以解决，那么这台电脑就是我心目中的完美最强六边形战士笔记本了（可惜解决不了，解决了也不会是现在这个价格）。目前最接近我心目中的完美笔记本应该就是今年的Thinkpad X1 Extreme了，静待发售之后的测评吧！

# 解决幻16睡眠自动唤醒问题

之前说过，幻16是一台好机器，但也不完全是一台好机器。除了硬件上的一些瑕疵，软件上也有一些问题。这些软件上的问题，很多都是由Win10带来的😐。最大的一个问题就是它会在睡眠的时候自动唤醒。下面讲讲我解决这个问题的坑爹过程。

某天在我睡觉时，原本在睡眠状态的电脑屏幕突然亮起，照亮了整个房间。过了一小会儿后屏幕又自动熄灭，电脑继续进入睡眠状态。见到如此情形，我顿时睡意全无，强迫症患者表示无法忍受。遂起身下床打开搜索引擎准备修bug。没想到这个bug一修就是将近3天。

首先在事件查看器中看看引起睡眠唤醒的原因。检查我在睡觉的时间内记录的系统日志，这个时候电脑应该都在睡眠状态（包括开盖和合盖时睡眠的情况）。经过我的总结，导致电脑自动唤醒的原因有下面几个：

- Input Mouse
- Input Keyboard
- 50（未知原因）

![](https://astrobear.top/resource/astroblog/content/sleep_issue_event_viewer.png)

首先解决Input Mouse/Keyboard的问题。经过一番查询，网络提供的解决办法为：在设备管理器中展开`鼠标和其他指针设备`，右键点击设备打开`属性`，在`电源管理`一栏中取消勾选`允许此设备唤醒计算机`。由于我是用的是无线鼠标，因此还需要在`键盘`选项中对`HID Keyboard Device`执行相同的操作。

![](https://astrobear.top/resource/astroblog/content/sleep_issue_mouse.png)

设置完成以后按`WIN+L`锁屏进入闲置状态进行测试，电脑仍然出现了自动唤醒的问题。多次复现问题后查看系统日志，发现自动唤醒的原因仍然有Input Mouse/Keyboard。于是关闭鼠标电源，再次测试，问题依旧。怒，直接拔掉鼠标接收器，睡眠得以正常。但是如果要每次离开电脑的时候都拔掉鼠标接收器，不但很麻烦，而且容易把接收器弄丢。网友分析出现这种状况有可能是Win10离开模式的锅。

右击电池图标进入`电源选项`，点击窗口右侧`更改计划设置`后再点击`更改高级电源设置`，在它的`睡眠`选项中竟然没有`允许离开模式策略`这个项设置。对比其他人的高级电源管理，我的电源管理中的可设置项只有寥寥几个。于是又是一番搜索，发现需要改注册表。于是按照方法修改注册表，解锁了大部分隐藏的设置（下一节会介绍）。关闭了离开模式以后再次进行测试，发现在锁屏状态下进入睡眠后仍然会有几率自动唤醒，无语。由电脑的电源指示灯我发现，锁定后电脑黑屏一段时间以后，指示灯才开始进行规律的闪烁，这标志着电脑真正进入睡眠状态了。而指示灯常亮且电脑黑屏时，电脑应该只是处于离开模式。于是我干脆把电脑在闲置状态下进入睡眠的时间缩短到5分钟，让鼠标在唤醒电脑之前直接让电脑从离开模式进入睡眠状态。至此，鼠标在无操作状态下唤醒电脑的问题得到了基本解决。

为了解决鼠标自动唤醒电脑的这个问题，我还尝试过在终端中通过命令的形式来修改设置以解决问题，但是同样也没有效果，遂放弃。可以说这个问题没有得到根本的解决，只是通过缩短进入睡眠的时间将它掩盖了。

本来以为问题已经解决了，但是！在晚上睡觉的时候，电脑屏幕又双叒亮了！暴起，合上屏幕继续睡觉、第二天起床查看系统日志，发现即使在合盖情况下，电脑仍会被唤醒，只是屏幕不会点亮而已。同时我还发现，电脑每隔一小时就会被唤醒一下，并且每次唤醒后系统日志的格式均如下所示：

- 系统正在退出连接待机状态，原因: 50
- 系统正在进入连接待机状态，原因: 50
- 进程 C:\Program Files\ASUS\ARMOURY CRATE Service\ArmouryCrate.UserSessionHelper.exe (进程 ID: 9384)将策略方案从 {381b4222-f694-41f0-9685-ff5bb260df2e} 重置为 {381b4222-f694-41f0-9685-ff5bb260df2e}

看样子这是奥创中心的服务，于是我去任务计划程序看看有什么程序是定时启动的。

在任务计划程序中左侧一栏中展开`任务计划程序库`，选择`ASUS`一栏。比对我的电脑睡眠自动唤醒的时间，我发现了其中一个程序的触发时间匹配上了唤醒时间，而且被设定为每小时触发一次。我将触发条件更改为`当任何用户登录时`后再进行测试，结果发现问题依旧......

![](https://astrobear.top/resource/astroblog/content/sleep_issue_planned_mission.png)

在走投无路的情况下，我直接把奥创中心卸载了，重启之后发现键盘背光没法亮了😑，只好又把奥创中心重新装了回去。突然我想到，如果不能删除奥创中心，我能不能只删除掉`ArmouryCrate.UserSessionHelper.exe `这个服务呢？

打开任务管理器，找到`ArmouryCrate.UserSessionHelper.exe `，右键打开菜单并点击`打开文件所在位置`。尝试删除这个程序，提示程序正在运行中无法删除。尝试通过剪切将程序移出当前文件夹，成功！然后在任务管理器中结束`ARMOURY CRATE Service`，可以发现任务管理器中`ArmouryCrate.UserSessionHelper.exe `没有再自动启动。

重启电脑后，经测试键盘背光灯可以正常工作。移除该服务后，奥创中心的功能会缺失不少，键盘上的奥创中心按键也无法再使用，但是核心功能——切换情景模式还是可以使用的。

![](https://astrobear.top/resource/astroblog/content/sleep_issue_armoury_crate.png)

再次进行睡眠测试，电脑终于不会再自动唤醒了！而且，电脑睡眠时不再烫手，风扇也不会再转了！

**罪魁祸首就是奥创中心！**

奥创中心将游戏本的性能和散热策略直接放在幻16上，只会让它又热又吵而且耗电还快。但其实把所有的锅都推给奥创中心是不太合理的，虽然这个软件确实垃圾。

实际上**最坑最坑的还是Windows 10强行推出的现代睡眠模式（S0睡眠）。**这个睡眠模式不同于以往的S3睡眠，S0睡眠下电脑除屏幕外其他设备都是供电的，相当于手机的熄屏状态。此外，由于微软一意孤行推广S0睡眠，这种睡眠模式还无法更改，甚至bios里都没有更改睡眠模式的选项。像我之前的电脑能设置S3睡眠，就没这么多屁事。

# 电源管理解锁

在折腾幻16的睡眠问题的时候我发现，机器上Win10的高级电源管理与其他人相比少了很多设置项。经过一番搜索之后，发现要通过修改注册表的方式来解锁这些设置。下面讲讲具体方法。

首先打开注册表编辑器，在左侧的资源管理器中找到这个文件夹：`计算机\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Power`。

在这个文件夹下，`PowerSettings`文件夹中的项目为高级电源管理的所有设置项，`\User\PowerSchemes`文件夹中的项目为所有的电源计划。

首先我们来解锁隐藏的电源计划。

在`\User\PowerSchemes`的目录下随便点开一个文件夹，这里以`27fa6203-3987-4dcc-918d-748559d549ec`为例。选中该文件夹之后，在右侧的项目中有一项名称为`FriendlyName`，这个项目的数据（值）为`Performance`。因此，该文件夹中的内容为`性能`模式的设置项。

![](https://astrobear.top/resource/astroblog/content/sleep_issue_power_settings1.png)

展开该文件夹，选中`245d8541-3943-4422-b025-13a784f679b7`这个文件夹，可以看到如下图所示的设置项。其中，`ACSettingIndex`和`DCSettingIndex`分别为该电源计划在交流供电和电池供电的情况下的可用性。如果值为`0`，则在该情况下不可用。因此，为了解锁这个隐藏的电源计划，我们要将这个两个设置项的值都设为`1`。

![](https://astrobear.top/resource/astroblog/content/sleep_issue_power_settings2.png)

鼠标右键点击设置项，选择`修改`。在修改它的值之后点击确定，会出现错误提示：`无法编辑xxx。编辑该值时出错。`，这是因为你没有权限修改这个值。

在左侧的资源管理器中右击当前文件夹，选择`权限`。

1. 在弹出的窗口中点击`高级`按钮
2. 在高级安全设置的窗口中，点击上方`所有者`右侧的蓝色`更改`选项
3. 然后还是在弹出的窗口中点击`高级`按钮
4. 在新的弹窗右侧点击`立即查找`
5. 在窗口下方找到你的用户名后选中
6. 点击`确定`
7. 点击`确定`
8. 你可以看到`所有者`变为自己的账户名

![](https://astrobear.top/resource/astroblog/content/sleep_issue_power_settings3.png)

执行完上面的步骤，你现在只是有了修改**修改注册表的权限**的权限，你还要执行下面的步骤以获得**修改注册表**的权限。

1. 在设置权限的窗口中点击`添加`
2. 在弹出的窗口中点击`高级`
3. 在新的弹窗右侧点击`立即查找`
4. 在窗口下方找到你的用户名后选中
5. 点击`确定`
6. 点击`确定`
7. 在`权限`一栏中的`完全控制`项中勾选`允许`
8. 点击`应用`
9. 你可以在`组或用户名`中看到自己的账户名

![](https://astrobear.top/resource/astroblog/content/sleep_issue_power_settings4.png)

点击`确定`关闭窗口，现在你应该可以修改该文件夹下注册表的值以解锁隐藏的电源计划了。修改完成后，在`电源选项`窗口中你可以发现，原本隐藏的电源计划出现了。

对于其他隐藏的电源计划，依照上面的方法举一反三同样可以解锁。区别仅仅在于需要选择不同电源计划的文件夹。而不同电源计划的设置项：`ACSettingIndex`和`DCSettingIndex`所在的文件夹都是电源计划的文件夹下名为`245d8541-3943-4422-b025-13a784f679b7`的文件夹。

然后来讲一下如何解锁高级电源管理的隐藏设置项。

解锁高级电源管理的隐藏设置项不需要更改权限，所以操作起来相对简单。在`计算机\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Power\PowerSettings`的路径下随便选择一个文件夹，这里以`238C9FA8-0AAD-41ED-83F4-97BE242C8F20`文件夹为例。选中之后，右侧`FriendlyName`项的值有`Sleep transition settings`，这指明了该文件夹下的设置项均为睡眠相关设置。

![](https://astrobear.top/resource/astroblog/content/sleep_issue_power_settings5.png)

点击该文件夹下的第二个文件夹`25DFA149-5DD1-4736-B5AB-E8A37B5B8187`，其右侧`FriendlyName`项的值有`Allow Away Mode Policy`。因此我们可以知道该项是用来设置离开模式的。对于任何一个设置项，只有`Attributes`的值为`2`时它才会在高级电源管理中显示，我们只需要右键`Attributes`并点击`修改`，将它的值改为`2`即可。

![](https://astrobear.top/resource/astroblog/content/sleep_issue_power_settings6.png)

对于其他隐藏的高级电源管理设置项，仿照上面的方法同样可以解锁。这里不再赘述。





